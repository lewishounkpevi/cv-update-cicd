% load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}
\usepackage{atbegshi} % Add this package

%% Set page size with a wider right margin
\geometry{a4paper, total={170mm,257mm}, left=10mm, top=10mm, bottom=5mm, right=10mm}

%% Let's define some colours
\definecolor{light}{HTML}{E6E6FA}
\definecolor{highlight}{HTML}{800080}
\definecolor{dark}{HTML}{f44336}

%% Let's add the border on the right hand side 
\AddToShipoutPictureBG*{% 
    \AtPageLowerLeft{% 
        \put(\LenToUnit{\dimexpr\paperwidth-0cm},0){% 
            \color{light}\rule{0cm}{\LenToUnit\paperheight}%
          }%
     }%
}

%% Add the logo only on the first page
\AddToShipoutPictureBG*{\AtTextLowerLeft{% 
    \ifnum\value{page}=1
        \put(\LenToUnit{\dimexpr\paperwidth-3.25cm},26.2cm){% move it to the top right
            \color{light}\includegraphics[width=1.5cm]{_extensions/nrennie/PrettyPDF/logo.png}
          }%
    \fi
}}

%% Style the page number
\fancypagestyle{mystyle}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \fancyfoot[R]{\thepage}
  \fancyfootoffset{3.5cm}
}

\setlength{\footskip}{20pt}

%% style the chapter/section fonts
\chapterfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\sectionfont{\color{blue}\fontsize{20}{10}\selectfont}
\subsectionfont{\color{red}\fontsize{8}{10}\selectfont}
\titleformat{\subsection}
  {\color{blue}\sffamily\Large\bfseries}{\thesubsection}{1em}{}[{\titlerule[0.8pt]}]
\titlespacing*{\subsection}{0pt}{*0}{*0}

%% Reduce space before and after section titles
\titlespacing*{\section}{0pt}{*0}{*0}

% left align title
\makeatletter
\renewcommand{\maketitle}{\bgroup\setlength{\parindent}{0pt}
\begin{flushleft}
  {\sffamily\huge\textbf{\MakeUppercase{\@title}}} \vspace{0.01cm} \newline
  {\Large {\@subtitle}}
  \@author
\end{flushleft}\egroup
}
\makeatother

%% Use some custom fonts
\setsansfont{Ubuntu}[
    Path=_extensions/nrennie/PrettyPDF/Ubuntu/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]

\setmainfont{Ubuntu}[
    Path=_extensions/nrennie/PrettyPDF/Ubuntu/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]
